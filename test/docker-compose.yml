##### authorize web-requests and certificate authority
authorize:
   build: authorize
   volumes:
     - /data
   environment:
     - START_NGNIX=yes
     - RootKey=
     - CaBase=/data/pki
     - CaPwdIm=
     - HostKeys=/data/sshd_keys
   ports:
     - "1082:80"
     - "2201:22"

##### this is the central control server
git:
   image: dtgilles/gitolite
   volumes:
     - /data
   environment:
     - RootKey=
     - SSH_KEY=
     - HostKeys=/data/sshd_keys
     - GIT_DATA=/data/git
     - EnableFeature=D
     - DisableFeature=daemon gitweb
   ports:
     - "2200:22"

registry:
   image: registry:2
   ports:
     - "5000"

rep:
   build: rep
   volumes:
     - /data
   environment:
     - DataDir=/data
     - ServerName=reverse.dreg.com
   #volumes_from:
   #  - vol_ssl:rw
   ports:
     - "44300:443"
   links:
     - registry
     - authorize

################################################################
#                           volumes                            #
################################################################
##### private volume for certificate authority
vol_ssl:
   image: busybox
   volumes:
     - /docker/test/data:/data

